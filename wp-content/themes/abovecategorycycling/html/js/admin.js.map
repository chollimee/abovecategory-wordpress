{"version":3,"sources":["admin/scripts/ProductsShow.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxFA;AAAA","file":"../html/js/admin.js","sourcesContent":["var ProductsShow = {\n  point_x: 0,\n  point_y: 0,\n\n  add_product: function()\n  {\n    jQuery('#acf-products .add-row-end').trigger('click');\n    jQuery('#acf-products .row:last td[data-field_name=point_x] input').val(this.point_x);\n    jQuery('#acf-products .row:last td[data-field_name=point_y] input').val(this.point_y);\n  },\n\n  add_product_marker: function(marker_id, x, y)\n  {\n    var marker = \"<div id='\" + marker_id + \"' class='marker product'><i class='fa fa-plus'></i></div>\";\n\n    jQuery('#acf-image .has-image').append(marker);\n    \n    jQuery(\"#\" + marker_id).css({left: x + '%', top: y + '%'});\n\n    jQuery('.marker').draggable({\n      stop: function(event) {\n        ProductsShow.update_row_data(jQuery(this).attr('id'))\n      }\n    }).bind('click', function(){\n      jQuery(this).focus();\n    });\n  },\n\n  update_row_data: function(marker_id)\n  {\n    var tr = jQuery(\"#acf-products .row[data-marker=\"+marker_id+\"]\");\n    var parentObject = jQuery('#acf-image .has-image');\n    var parentWidth = parentObject.width();\n    var parentHeight = parentObject.height();\n    var marker = jQuery(\"#\" + marker_id);\n\n    var x = 100 * (( marker.offset().left - parentObject.offset().left ) / parentWidth);\n    var y = 100 * (( marker.offset().top - parentObject.offset().top ) / parentHeight);\n\n    ProductsShow.point_x = x;\n    ProductsShow.point_y = y;\n\n    ProductsShow.update_metabox();\n\n    jQuery('td[data-field_name=point_x] input', tr).val(x);\n    jQuery('td[data-field_name=point_y] input', tr).val(y);\n  },\n\n  update_metabox: function()\n  {\n    jQuery('#point_x').html(this.point_x);\n    jQuery('#point_y').html(this.point_y);\n  },\n\n  move_marker_position: function()\n  {\n    jQuery('#marker').css({left: ProductsShow.point_x + '%', top: ProductsShow.point_y + '%'});\n  },\n\n  initialize: function()\n  {\n    var marker = \"<div id='marker' class='marker'><i class='fa fa-plus'></i></div>\";\n    jQuery(function(){\n      jQuery('#acf-image .has-image').append(marker);\n      jQuery('img.acf-image-image').bind('click', function(e){\n        var parentOffset = jQuery(this).parent().offset();\n        var parentWidth = jQuery(this).parent().width();\n        var parentHeight = jQuery(this).parent().height();\n\n        ProductsShow.point_x = 100 * (e.pageX - parentOffset.left) / parentWidth;\n        ProductsShow.point_y = 100 * (e.pageY - parentOffset.top) / parentHeight;\n        ProductsShow.update_metabox();\n        ProductsShow.move_marker_position();\n      });\n\n      jQuery('#acf-products .row').each(function(index, tr){\n        var x = jQuery('td[data-field_name=point_x] input', tr).val();\n        var y = jQuery('td[data-field_name=point_y] input', tr).val();\n        var marker_id = \"marker\"+index;\n\n        jQuery(tr).attr(\"data-marker\", marker_id);\n        ProductsShow.add_product_marker(marker_id, x, y);\n      });\n\n    });\n  }\n}\n\nmodule.exports = ProductsShow;"]}